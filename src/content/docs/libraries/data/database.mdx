---
title: Database
group: Libraries
description: Database abstraction layer supporting multiple database engines.
---

import { Card, CardGrid, LibraryHeader } from '@components/mdx';

<LibraryHeader
	title="Database"
	description="The Utopia Database library provides a unified interface for working with different database engines, making it easy to switch between databases or support multiple databases in your application."
	tagline="Database abstraction layer supporting multiple database engines"
	githubUrl="https://github.com/utopia-php/database"
	stars={72}
	category="Data"
/>

## Overview

The Database library abstracts away the differences between various database engines, providing a consistent API for common database operations while maintaining high performance and flexibility.

## Key Features

<CardGrid>
	<Card title="Multi-Engine Support" icon="blocks" gradient="blue">
		Support for MySQL, PostgreSQL, MongoDB, and more database engines.
	</Card>
	<Card title="Query Builder" icon="brush" gradient="purple">
		Intuitive query builder for complex database operations.
	</Card>
	<Card title="Connection Pooling" icon="lightbulb" gradient="orange">
		Efficient connection management with built-in pooling.
	</Card>
	<Card title="Transaction Support" icon="sparkles" gradient="green">
		Full ACID transaction support with rollback capabilities.
	</Card>
</CardGrid>

## Quick Start

### Installation

```bash
composer require utopia-php/database
```

### Basic Usage

```php
<?php

require_once __DIR__ . '/vendor/autoload.php';

use Utopia\Database\Database;
use Utopia\Database\Document;

$database = new Database();

// Create a collection
$database->createCollection('users');

// Insert a document
$user = $database->createDocument('users', new Document([
    'name' => 'John Doe',
    'email' => 'john@example.com',
    'created' => time()
]));

// Find documents
$users = $database->find('users', [
    'email' => 'john@example.com'
]);

// Update a document
$database->updateDocument('users', $user->getId(), [
    'name' => 'John Smith'
]);

// Delete a document
$database->deleteDocument('users', $user->getId());
```

## Supported Databases

- **MySQL** - Relational database with full SQL support
- **PostgreSQL** - Advanced relational database with JSON support
- **MongoDB** - Document-based NoSQL database
- **SQLite** - Lightweight file-based database
- **Redis** - In-memory data structure store

## API Reference

### Database Class

The main database class that handles connections and operations.

#### Methods

- `createCollection(string $name)` - Create a new collection/table
- `createDocument(string $collection, Document $document)` - Insert a new document
- `find(string $collection, array $filters)` - Find documents matching criteria
- `updateDocument(string $collection, string $id, array $data)` - Update a document
- `deleteDocument(string $collection, string $id)` - Delete a document
- `beginTransaction()` - Start a database transaction
- `commit()` - Commit the current transaction
- `rollback()` - Rollback the current transaction

### Document Class

Represents a database document with helper methods.

#### Methods

- `getId()` - Get document ID
- `getAttribute(string $key)` - Get document attribute
- `setAttribute(string $key, mixed $value)` - Set document attribute
- `toArray()` - Convert document to array

## Examples

### Complex Queries

```php
// Find users with pagination
$users = $database->find('users', [
    'age' => ['>=' => 18],
    'status' => 'active'
], [
    'limit' => 10,
    'offset' => 20,
    'orderBy' => 'created',
    'orderDirection' => 'DESC'
]);

// Aggregate data
$stats = $database->aggregate('users', [
    ['$group' => [
        'id' => '$status',
        'count' => ['$sum' => 1]
    ]]
]);
```

### Transactions

```php
$database->beginTransaction();

try {
    $user = $database->createDocument('users', new Document([
        'name' => 'Jane Doe',
        'email' => 'jane@example.com'
    ]));
    
    $profile = $database->createDocument('profiles', new Document([
        'user_id' => $user->getId(),
        'bio' => 'Software Developer'
    ]));
    
    $database->commit();
} catch (Exception $e) {
    $database->rollback();
    throw $e;
}
```

## Performance

The Database library is optimized for:

- **Connection Pooling**: Efficient connection management
- **Query Optimization**: Automatic query optimization and caching
- **Batch Operations**: Support for bulk insert/update operations
- **Indexing**: Automatic index creation and management

## GitHub Repository

[View on GitHub](https://github.com/utopia-php/database) • ⭐ 72 stars

## Related Libraries

- [HTTP](/http) - Web framework for API endpoints
- [Cache](/cache) - Caching layer for database queries
- [Logger](/logger) - Database operation logging

